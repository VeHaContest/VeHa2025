Правка в предикате AbleToMergeButNotPullOrPush была внесена для исправления критической логической ошибки в условиях активации действия Merge. Исходная версия предиката проверяла только то, что операции Pull и Push невозможны, то есть что оба предиката AbleToPull и AbleToPush возвращают ложь. Однако такое условие является недостаточным, поскольку оно истинно в двух принципиально различных ситуациях.

В первой ситуации логи пользователя и сервера действительно расходятся и требуется операция слияния с разрешением конфликтов. Именно для этого случая и предназначено действие Merge. Во второй ситуации логи пользователя и сервера полностью идентичны, то есть синхронизация уже достигнута и никакого слияния не требуется. При исходной версии предиката система не могла различить эти два состояния, что приводило к попыткам выполнения Merge в ситуациях, когда логи уже синхронизированы.

Добавленная часть предиката явно проверяет наличие расхождения между логами пользователя и сервера. Она использует дизъюнкцию двух условий. Первое условие проверяет случай, когда общие части логов совпадают, но длины различаются, что означает наличие дополнительных локальных изменений у одной из сторон. Второе условие проверяет существование индекса, на котором записи в логах различаются, то есть наличие настоящего конфликта изменений.

Без этой правки спецификация работала бы некорректно. Действие Next не могло бы правильно определить, какое действие должно быть выполнено в каждом состоянии системы. Более того, инварианты спецификации нарушались бы, поскольку система пыталась применять операцию слияния к уже синхронизированным логам, что приводило к неопределенному поведению и ошибкам выполнения.